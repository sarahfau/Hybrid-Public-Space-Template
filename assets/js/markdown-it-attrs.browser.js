!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownItAttrs=t()}}(function(){return function(){return function t(f,m,n){function D(A,x){if(!m[A]){if(!f[A]){var i="function"==typeof require&&require;if(!x&&i)return i(A,!0);if(b)return b(A,!0);var O=new Error("Cannot find module '"+A+"'");throw O.code="MODULE_NOT_FOUND",O}var E=m[A]={exports:{}};f[A][0].call(E.exports,function(t){return D(f[A][1][t]||t)},E,E.exports,t,f,m,n)}return m[A].exports}for(var b="function"==typeof require&&require,A=0;A<n.length;A++)D(n[A]);return D}}()({1:[function(t,f,m){"use strict";const n=t("./patterns.js"),D={leftDelimiter:"{",rightDelimiter:"}"};function b(t,f,m){let n={match:!1,j:null},D=void 0!==m.shift?f+m.shift:m.position,O=(E=t,(M=D)>=0?E[M]:E[E.length+M]);var E,M;if(void 0===O)return n;for(let t in m)if("shift"!==t&&"position"!==t){if(void 0===O[t])return n;if("children"===t&&A(m.children)){if(0===O.children.length)return n;let t,f=m.children,D=O.children;if(f.every(t=>void 0!==t.position)){if(t=f.every(t=>b(D,t.position,t).match)){let t=i(f).position;n.j=t>=0?t:D.length+t}}else for(let m=0;m<D.length;m++)if(t=f.every(t=>b(D,m,t).match)){n.j=m;break}if(!1===t)return n}else switch(typeof m[t]){case"boolean":case"number":case"string":if(O[t]!==m[t])return n;break;case"function":if(!m[t](O[t]))return n;break;case"object":if(x(m[t])){if(!1===m[t].every(f=>f(O[t])))return n;break}default:throw new Error(`Unknown type of pattern test (key: ${t}). Test should be of type boolean, number, string, function or array of functions.`)}}return n.match=!0,n}function A(t){return Array.isArray(t)&&t.length&&t.every(t=>"object"==typeof t)}function x(t){return Array.isArray(t)&&t.length&&t.every(t=>"function"==typeof t)}function i(t){return t.slice(-1)[0]||{}}f.exports=function(t,f){f||(f=D);const m=n(f);t.core.ruler.before("linkify","curly_attributes",function(t){let f=t.tokens;for(let t=0;t<f.length;t++)for(let n=0;n<m.length;n++){let D=m[n],A=null;D.tests.every(m=>{let n=b(f,t,m);return null!==n.j&&(A=n.j),n.match})&&(D.transform(f,t,A),"inline attributes"!==D.name&&"inline nesting 0"!==D.name||n--)}})}},{"./patterns.js":2}],2:[function(t,f,m){"use strict";const n=t("./utils.js");function D(t){return t.slice(-1)[0]}f.exports=(t=>{const f=new RegExp("^ {0,3}[-*_]{3,} ?"+n.escapeRegExp(t.leftDelimiter)+"[^"+n.escapeRegExp(t.rightDelimiter)+"]");return[{name:"fenced code blocks",tests:[{shift:0,block:!0,info:n.hasDelimiters("end",t)}],transform:(f,m)=>{let D=f[m],b=D.info.lastIndexOf(t.leftDelimiter),A=n.getAttrs(D.info,b,t);n.addAttrs(A,D),D.info=n.removeDelimiter(D.info,t)}},{name:"inline nesting 0",tests:[{shift:0,type:"inline",children:[{shift:-1,type:t=>"image"===t||"code_inline"===t},{shift:0,type:"text",content:n.hasDelimiters("start",t)}]}],transform:(f,m,D)=>{let b=f[m].children[D],A=b.content.indexOf(t.rightDelimiter),x=f[m].children[D-1],i=n.getAttrs(b.content,0,t);n.addAttrs(i,x),b.content.length===A+t.rightDelimiter.length?f[m].children.splice(D,1):b.content=b.content.slice(A+t.rightDelimiter.length)}},{name:"tables",tests:[{shift:0,type:"table_close"},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:n.hasDelimiters("only",t)}],transform:(f,m)=>{let D=f[m+2],b=n.getMatchingOpeningToken(f,m),A=n.getAttrs(D.content,0,t);n.addAttrs(A,b),f.splice(m+1,3)}},{name:"inline attributes",tests:[{shift:0,type:"inline",children:[{shift:-1,nesting:-1},{shift:0,type:"text",content:n.hasDelimiters("start",t)}]}],transform:(f,m,D)=>{let b=f[m].children[D],A=b.content,x=n.getAttrs(A,0,t),i=n.getMatchingOpeningToken(f[m].children,D-1);n.addAttrs(x,i),b.content=A.slice(A.indexOf(t.rightDelimiter)+t.rightDelimiter.length)}},{name:"list softbreak",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,content:n.hasDelimiters("only",t)}]}],transform:(f,m,D)=>{let b=f[m].children[D].content,A=n.getAttrs(b,0,t),x=m-2;for(;f[x-1]&&"ordered_list_open"!==f[x-1].type&&"bullet_list_open"!==f[x-1].type;)x--;n.addAttrs(A,f[x-1]),f[m].children=f[m].children.slice(0,-2)}},{name:"list double softbreak",tests:[{shift:0,type:t=>"bullet_list_close"===t||"ordered_list_close"===t},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:n.hasDelimiters("only",t),children:t=>1===t.length},{shift:3,type:"paragraph_close"}],transform:(f,m)=>{let D=f[m+2].content,b=n.getAttrs(D,0,t),A=n.getMatchingOpeningToken(f,m);n.addAttrs(b,A),f.splice(m+1,3)}},{name:"list item end",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-1,content:n.hasDelimiters("end",t)}]}],transform:(f,m,b)=>{let A=f[m].children[b],x=A.content,i=n.getAttrs(x,x.lastIndexOf(t.leftDelimiter),t);n.addAttrs(i,f[m-2]);let O=x.slice(0,x.lastIndexOf(t.leftDelimiter));A.content=" "!==D(O)?O:O.slice(0,-1)}},{name:"\n{.a} softbreak then curly in start",tests:[{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:n.hasDelimiters("only",t)}]}],transform:(f,m,D)=>{let b=f[m].children[D],A=n.getAttrs(b.content,0,t),x=m+1;for(;f[x+1]&&-1===f[x+1].nesting;)x++;let i=n.getMatchingOpeningToken(f,x);n.addAttrs(A,i),f[m].children=f[m].children.slice(0,-2)}},{name:"horizontal rule",tests:[{shift:0,type:"paragraph_open"},{shift:1,type:"inline",children:t=>1===t.length,content:t=>null!==t.match(f)},{shift:2,type:"paragraph_close"}],transform:(f,m)=>{let D=f[m];D.type="hr",D.tag="hr",D.nesting=0;let b=f[m+1].content,A=b.lastIndexOf(t.leftDelimiter);D.attrs=n.getAttrs(b,A,t),D.markup=b,f.splice(m+1,2)}},{name:"end of block",tests:[{shift:0,type:"inline",children:[{position:-1,content:n.hasDelimiters("end",t),type:t=>"code_inline"!==t}]}],transform:(f,m,b)=>{let A=f[m].children[b],x=A.content,i=n.getAttrs(x,x.lastIndexOf(t.leftDelimiter),t),O=m+1;for(;f[O+1]&&-1===f[O+1].nesting;)O++;let E=n.getMatchingOpeningToken(f,O);n.addAttrs(i,E);let M=x.slice(0,x.lastIndexOf(t.leftDelimiter));A.content=" "!==D(M)?M:M.slice(0,-1)}}]})},{"./utils.js":3}],3:[function(t,f,m){"use strict";function n(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}m.getAttrs=function(t,f,m){const n=/[^\t\n\f \/>"'=]/,D=[];let b="",A="",x=!0,i=!1;for(let O=f+m.leftDelimiter.length;O<t.length;O++){if(t.slice(O,O+m.rightDelimiter.length)===m.rightDelimiter){""!==b&&D.push([b,A]);break}let f=t.charAt(O);if("="===f&&x)x=!1;else if("."!==f||""!==b)if("#"!==f||""!==b)if('"'!==f||""!==A)if('"'===f&&i)i=!1;else if(" "!==f||i)x&&-1===f.search(n)||(x?b+=f:A+=f);else{if(""===b)continue;D.push([b,A]),b="",A="",x=!0}else i=!0;else b="id",x=!1;else"."===t.charAt(O+1)?(b="css-module",O+=1):b="class",x=!1}return D},m.addAttrs=function(t,f){for(let m=0,n=t.length;m<n;++m){let n=t[m][0];"class"===n?f.attrJoin("class",t[m][1]):"css-module"===n?f.attrJoin("css-module",t[m][1]):f.attrPush(t[m])}return f},m.hasDelimiters=function(t,f){if(!t)throw new Error('Parameter `where` not passed. Should be "start", "middle", "end" or "only".');return function(m){let n,D,b,A,x=f.leftDelimiter.length+1+f.rightDelimiter.length;if(!m||"string"!=typeof m||m.length<x)return!1;let i=x-f.rightDelimiter.length;switch(t){case"start":D=-1===(n=(b=m.slice(0,f.leftDelimiter.length))===f.leftDelimiter?0:-1)?-1:m.indexOf(f.rightDelimiter,i),(A=m.charAt(D+f.rightDelimiter.length))&&-1!==f.rightDelimiter.indexOf(A)&&(D=-1);break;case"end":D=(D=-1===(n=m.lastIndexOf(f.leftDelimiter))?-1:m.indexOf(f.rightDelimiter,n+i))===m.length-f.rightDelimiter.length?D:-1;break;case"only":n=(b=m.slice(0,f.leftDelimiter.length))===f.leftDelimiter?0:-1,D=(b=m.slice(m.length-f.rightDelimiter.length))===f.rightDelimiter?m.length-f.rightDelimiter.length:-1}return-1!==n&&-1!==D&&function(t){let m="."===t.charAt(f.leftDelimiter.length),n="#"===t.charAt(f.leftDelimiter.length);return m||n?t.length>=x+1:t.length>=x}(m.substring(n,D+f.rightDelimiter.length))}},m.removeDelimiter=function(t,f){const m=n(f.leftDelimiter),D=n(f.rightDelimiter);let b=new RegExp("[ \\n]?"+m+"[^"+m+D+"]+"+D+"$"),A=t.search(b);return-1!==A?t.slice(0,A):t},m.escapeRegExp=n,m.getMatchingOpeningToken=function(t,f){if("softbreak"===t[f].type)return!1;if(0===t[f].nesting)return t[f];let m=t[f].block?t[f].level:t[f].level+1,n=t[f].type.replace("_close","_open");for(;f>=0;--f)if(t[f].type===n&&t[f].level===m)return t[f]};let D=/[&<>"]/,b=/[&<>"]/g,A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function x(t){return A[t]}m.escapeHtml=function(t){return D.test(t)?t.replace(b,x):t}},{}]},{},[1])(1)});
